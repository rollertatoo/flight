!function(){"use strict";let n,t,e,r,o,i,c,u,s,a;!function(n){n.TRACKING_ACCEPTED="trackingConsentAccepted",n.TRACKING_DECLINED="trackingConsentDeclined",n.FIRST_PARTY_MARKETING_ACCEPTED="firstPartyMarketingConsentAccepted",n.THIRD_PARTY_MARKETING_ACCEPTED="thirdPartyMarketingConsentAccepted",n.ANALYTICS_ACCEPTED="analyticsConsentAccepted",n.PREFERENCES_ACCEPTED="preferencesConsentAccepted",n.FIRST_PARTY_MARKETING_DECLINED="firstPartyMarketingConsentDeclined",n.THIRD_PARTY_MARKETING_DECLINED="thirdPartyMarketingConsentDeclined",n.ANALYTICS_DECLINED="analyticsConsentDeclined",n.PREFERENCES_DECLINED="preferencesConsentDeclined",n.CONSENT_COLLECTED="visitorConsentCollected"}(n||(n={})),function(n){n.V2_0="2.0",n.V2_1="2.1"}(t||(t={})),function(n){n.ACCEPTED="yes",n.DECLINED="no",n.NO_INTERACTION="no_interaction",n.NO_VALUE=""}(e||(e={})),function(n){n.NO_VALUE="",n.ACCEPTED="1",n.DECLINED="0"}(r||(r={})),function(n){n.GDPR="GDPR",n.CCPA="CCPA",n.NO_VALUE=""}(o||(o={})),function(n){n.PREFERENCES="p",n.ANALYTICS="a",n.FIRST_PARTY_MARKETING="m",n.THIRD_PARTY_MARKETING="t"}(i||(i={})),function(n){n.CCPA_BLOCK_ALL="CCPA_BLOCK_ALL",n.GDPR="GDPR",n.GDPR_BLOCK_ALL="GDPR_BLOCK_ALL",n.CCPA="CCPA"}(c||(c={})),function(n){n.MARKETING="m",n.ANALYTICS="a",n.PREFERENCES="p",n.GPC="g",n.SALE_OF_DATA="s"}(u||(u={})),function(n){n.MARKETING="m",n.ANALYTICS="a",n.PREFERENCES="p",n.GPC="g",n.SALE_OF_DATA="s"}(s||(s={})),function(n){n.MARKETING="marketing",n.ANALYTICS="analytics",n.PREFERENCES="preferences",n.GPC="gpc",n.SALE_OF_DATA="sale_of_data"}(a||(a={}));const C=["lim","v","con","reg"];function E(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function A(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?E(Object(e),!0).forEach((function(t){l(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):E(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function l(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}let f={};function T(n){if(n in f)return f[n];const t=document.cookie?document.cookie.split("; "):[];f[n]=void 0;for(let e=0;e<t.length;e++){const[r,o]=t[e].split("=");if(n===decodeURIComponent(r)){f[n]=JSON.parse(decodeURIComponent(o));break}}return f[n]}function P(){const n=T("_tracking_consent");if(void 0!==n&&!function(n){if(![t.V2_0,t.V2_1].includes(n.v))return!0;return!function(n,t){const e=t.slice().sort();return n.length===t.length&&n.slice().sort().every((n,t)=>n===e[t])}(Object.keys(n).filter(n=>"region"!==n),C)}(n))return n}function R(){try{let n=P();if(!n)return;return n.v===t.V2_0?function(n){const e=n.con||{};return{con:{CMP:{[s.MARKETING]:e.GDPR||r.NO_VALUE,[u.ANALYTICS]:e.GDPR||r.NO_VALUE,[u.PREFERENCES]:e.GDPR||r.NO_VALUE,[u.GPC]:r.NO_VALUE,[u.SALE_OF_DATA]:e.CCPA||r.NO_VALUE}},reg:n.reg,v:t.V2_1,lim:n.lim}}(n):n}catch(n){return}}function _(){const n=P();switch(null==n?void 0:n.v){case"2.0":return t.V2_0;case"2.1":return t.V2_1;default:return}}function N(){return{m:L(s.MARKETING),a:L(s.ANALYTICS),p:L(s.PREFERENCES),s:L(s.SALE_OF_DATA),g:L(s.GPC)}}function d(){return N()[s.SALE_OF_DATA]}function I(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===n&&(n=R()),void 0===n}function D(n){switch(n){case r.ACCEPTED:return e.ACCEPTED;case r.DECLINED:return e.DECLINED;default:return e.NO_VALUE}}function g(n){switch(n){case u.ANALYTICS:return a.ANALYTICS;case u.MARKETING:return a.MARKETING;case u.PREFERENCES:return a.PREFERENCES;case u.SALE_OF_DATA:return a.SALE_OF_DATA;case u.GPC:return a.GPC}}function L(n){if(n==s.GPC){if(!W.isGPCSignalPresent())return r.NO_VALUE;return!W.isGPCOptOutPresent()?r.ACCEPTED:r.DECLINED}const t=R();if(!t)return r.NO_VALUE;const e=t.con.CMP;return e?e[n]:r.NO_VALUE}function p(){return T("_cmp_a")}function S(n){const t=p();if(!t)return!0;const e=t.purposes[n];return"boolean"!=typeof e||e}function h(){return S(i.PREFERENCES)}function O(){return S(i.ANALYTICS)}function y(){return S(i.FIRST_PARTY_MARKETING)}function G(){return S(i.THIRD_PARTY_MARKETING)}const w={"":[],GDPR:[c.GDPR,c.GDPR_BLOCK_ALL],CCPA:[c.CCPA_BLOCK_ALL,c.CCPA]};function b(n,t){document.dispatchEvent(new CustomEvent(n,{detail:t||{}}))}function m(t){!0===t[i.FIRST_PARTY_MARKETING]?b(n.FIRST_PARTY_MARKETING_ACCEPTED):!1===t[i.FIRST_PARTY_MARKETING]&&b(n.FIRST_PARTY_MARKETING_DECLINED),!0===t[i.THIRD_PARTY_MARKETING]?b(n.THIRD_PARTY_MARKETING_ACCEPTED):!1===t[i.THIRD_PARTY_MARKETING]&&b(n.THIRD_PARTY_MARKETING_DECLINED),!0===t[i.ANALYTICS]?b(n.ANALYTICS_ACCEPTED):!1===t[i.ANALYTICS]&&b(n.ANALYTICS_DECLINED),!0===t[i.PREFERENCES]?b(n.PREFERENCES_ACCEPTED):!1===t[i.PREFERENCES]&&b(n.PREFERENCES_DECLINED);const e=function(n){return{firstPartyMarketingAllowed:n[i.FIRST_PARTY_MARKETING],thirdPartyMarketingAllowed:n[i.THIRD_PARTY_MARKETING],analyticsAllowed:n[i.ANALYTICS],preferencesAllowed:n[i.PREFERENCES]}}(t);b(n.CONSENT_COLLECTED,e)}function v(t,e,r){const o=new XMLHttpRequest,c=JSON.stringify(t);o.open("POST","/set_tracking_consent.json",!0),o.setRequestHeader("Content-Type","application/json"),o.onreadystatechange=function(){if(4!==o.readyState)return;f={};const c=function(n){try{return JSON.parse(n)}catch(n){return{error:"Unknown error"}}}(o.responseText);var u;0===(u=o.status)||200>=u&&u<400?(!function(t,e){void 0!==t.consent?(!0===t.consent?b(n.TRACKING_ACCEPTED):b(n.TRACKING_DECLINED),e&&m({[i.PREFERENCES]:t.consent,[i.ANALYTICS]:t.consent,[i.FIRST_PARTY_MARKETING]:t.consent,[i.THIRD_PARTY_MARKETING]:t.consent})):void 0!==t.granular_consent&&m({[i.PREFERENCES]:h(),[i.ANALYTICS]:O(),[i.FIRST_PARTY_MARKETING]:y(),[i.THIRD_PARTY_MARKETING]:G()})}(t,r),e(null,c)):e(c)},o.send(c)}function M(){if(I())return e.NO_VALUE;const n=N();return n[u.MARKETING]===r.ACCEPTED&&n[u.ANALYTICS]===r.ACCEPTED?e.ACCEPTED:n[u.MARKETING]===r.DECLINED||n[u.ANALYTICS]===r.DECLINED?e.DECLINED:e.NO_INTERACTION}function K(){const n=function(){const n=R();return I(n)?o.NO_VALUE:n.reg}();return n in o?n:o.NO_VALUE}function k(){return function(){const n=R();return I(n)?{limit:[]}:{limit:n.lim}}()}function Y(n){return x(c.GDPR_BLOCK_ALL)&&n?B()?document.referrer:"":null}function F(n){return x(c.GDPR_BLOCK_ALL)&&n?B()?window.location.pathname+window.location.search:"/":null}function V(){return"string"==typeof navigator.globalPrivacyControl?"1"===navigator.globalPrivacyControl:Boolean(navigator.globalPrivacyControl)}function B(){if(""===document.referrer)return!0;const n=document.createElement("a");return n.href=document.referrer,window.location.hostname!=n.hostname}function j(){return x(c.GDPR)||x(c.GDPR_BLOCK_ALL)}function U(){const n=K();if(n===o.NO_VALUE)return!1;const t=k();return 0!==t.limit.length&&t.limit.some(t=>function(n,t){return w[n].includes(t)}(n,t))}function H(){return!!I()||function(){if(!j())return!0;const n=N();return n[u.MARKETING]===r.ACCEPTED&&n[u.ANALYTICS]===r.ACCEPTED||n[u.MARKETING]!==r.DECLINED&&n[u.ANALYTICS]!==r.DECLINED&&K()!==o.GDPR}()}function x(n){return k().limit.includes(n)}function q(){return K()===o.CCPA&&(!!x(c.CCPA)&&V())}function J(){return!q()&&(!!I()||!1!==H()&&function(){if(x(c.CCPA_BLOCK_ALL)){return K()!==o.CCPA}if(x(c.CCPA)){return d()!==r.DECLINED}return!0}())}function X(){return q()?e.DECLINED:(n=d(),I()?e.NO_VALUE:n===r.NO_VALUE?e.NO_INTERACTION:D(n));var n}function z(n){if(!j())return!0;const t=N();return t[n]===r.ACCEPTED||t[n]!==r.DECLINED&&K()!==o.GDPR}function Q(){return _()===t.V2_1}const W={getTrackingConsent:M,setTrackingConsent:function(n,t){if(I()){const n="Shop is not configured to block privacy regulation in online store settings.";return console.warn(n),t({error:n})}if(function(n){if(Q()){if("boolean"!=typeof n&&"object"!=typeof n)throw TypeError("setTrackingConsent must be called with a boolean or object consent value");if("object"==typeof n){const t=Object.keys(n);if(0===t.length)throw TypeError("The submitted consent object is empty.");const e=[a.MARKETING,a.ANALYTICS,a.PREFERENCES,a.SALE_OF_DATA];for(const n of t)if(!e.includes(n))throw TypeError("The submitted consent object should only contain the following keys: ".concat(e.join(", "),"."))}}else if("boolean"!=typeof n)throw TypeError("setTrackingConsent must be called with a boolean consent value")}(n),"function"!=typeof t)throw TypeError("setTrackingConsent must be called with a callback function");if("object"==typeof n){const e=Y(n.analytics),r=F(n.analytics);return v(A(A({granular_consent:n},null!==e&&{referrer:e}),null!==r&&{landing_page:r}),t,Q())}{const e=Y(n),r=F(n);return v(A(A({consent:n},null!==e&&{referrer:e}),null!==r&&{landing_page:r}),t,Q())}},userCanBeTracked:H,getRegulation:K,isRegulationEnforced:U,getShopPrefs:k,shouldShowGDPRBanner:function(){return K()===o.GDPR&&U()&&M()===e.NO_INTERACTION},userDataCanBeSold:J,setCCPAConsent:function(n,t){if("boolean"!=typeof n)throw TypeError("setCCPAConsent must be called with a boolean consent value");if("function"!=typeof t)throw TypeError("setCCPAConsent must be called with a callback function");return v({ccpa_consent:n},t,Q())},getCCPAConsent:X,shouldShowCCPABanner:function(){return K()===o.CCPA&&k().limit.includes(c.CCPA)&&X()===e.NO_INTERACTION},haveAnalyticsConsent:function(){return Q()?O():z(u.ANALYTICS)},havePreferencesConsent:function(){return Q()?h():z(u.PREFERENCES)},haveFirstPartyMarketingConsent:function(){return Q()?y():z(u.MARKETING)},haveThirdPartyMarketingConsent:function(){return Q()?G():!!z(u.MARKETING)&&!!J()},getCCPAConsentValue:d,merchantEnforcingRegulationLimit:x,isGPCSignalPresent:function(){return void 0!==navigator.globalPrivacyControl},isGPCOptOutPresent:V,isValidGPCSignalOptOutPresent:q,exposeBetaFunctionality:Q,shouldShowBanner:function(){return Q()&&function(){const n=p();return!!n&&("boolean"==typeof n.display_banner&&n.display_banner)}()&&L(s.ANALYTICS)===r.NO_VALUE&&L(s.MARKETING)===r.NO_VALUE&&L(s.PREFERENCES)===r.NO_VALUE},saleOfDataRegion:function(){return Q()&&function(){const n=p();return n&&n.sale_of_data_region||!1}()}};function Z(n,t,e){try{var r;!function(n){const t=new XMLHttpRequest;t.open("POST","https://notify.bugsnag.com/",!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Bugsnag-Api-Key","95ba910bcec4542ef2a0b64cd7ca666c"),t.setRequestHeader("Bugsnag-Payload-Version","5");const e=function(n){const t=function(n){return n.stackTrace||n.stack||n.description||n.name}(n.error),[e,r]=(t||"unknown error").split("\n")[0].split(":");return JSON.stringify({payloadVersion:5,notifier:{name:"ConsentTrackingAPI",version:"latest",url:"-"},events:[{exceptions:[{errorClass:(e||"").trim(),message:(r||"").trim(),stacktrace:[{file:"consent-tracking-api.js",lineNumber:"1",method:t}],type:"browserjs"}],context:n.context||"general",app:{id:"ConsentTrackingAPI",version:"latest"},metaData:{request:{shopId:n.shopId,shopUrl:window.location.href},device:{userAgent:window.navigator.userAgent},"Additional Notes":n.notes},unhandled:!1}]})}(n);t.send(e)}({error:n,context:t,shopId:nn()||(null===(r=window.Shopify)||void 0===r?void 0:r.shop),notes:e})}catch(n){}}function $(n){return function(){try{return n(...arguments)}catch(n){throw Z(n),n}}}function nn(){try{const n=document.getElementById("shopify-features").textContent;return JSON.parse(n).shopId}catch(n){return null}}function tn(){return W.getTrackingConsent()}function en(n,t){return W.setTrackingConsent(n,t)}function rn(){return W.userCanBeTracked()}function on(){return W.getRegulation()}function cn(){return W.isRegulationEnforced()}function un(){return W.getShopPrefs()}function sn(){return W.shouldShowGDPRBanner()}function an(){return W.userDataCanBeSold()}function Cn(n,t){return W.setCCPAConsent(n,t)}function En(){return W.getCCPAConsent()}function An(){return W.shouldShowCCPABanner()}function ln(){return W.haveAnalyticsConsent()}function fn(){return W.havePreferencesConsent()}function Tn(){return W.haveFirstPartyMarketingConsent()}function Pn(){return W.haveThirdPartyMarketingConsent()}function Rn(){return W.shouldShowBanner()}function _n(){return W.saleOfDataRegion()}function Nn(){return _()===t.V2_1}function dn(){return Nn()}function In(){const n={};if(t=c.GDPR_BLOCK_ALL,un().limit.includes(t)&&Nn()){const t=N();for(const e of Object.keys(t))n[g(e)]=D(t[e])}var t;return n}function Dn(){W.getCCPAConsentValue()!=r.DECLINED&&W.isValidGPCSignalOptOutPresent()&&Cn(!1,()=>!1);const n={getTrackingConsent:$(tn),setTrackingConsent:$(en),userCanBeTracked:$(rn),getRegulation:$(on),isRegulationEnforced:$(cn),getShopPrefs:$(un),shouldShowGDPRBanner:$(sn),userDataCanBeSold:$(an),setCCPAConsent:$(Cn),getCCPAConsent:$(En),shouldShowCCPABanner:$(An),doesMerchantSupportGranularConsent:$(dn)};if(W.exposeBetaFunctionality()){const t={analyticsProcessingAllowed:$(ln),preferencesProcessingAllowed:$(fn),firstPartyMarketingAllowed:$(Tn),thirdPartyMarketingAllowed:$(Pn),currentVisitorConsent:$(In),shouldShowBanner:$(Rn),saleOfDataRegion:$(_n)};n.unstable=t}return n}window.Shopify=window.Shopify?window.Shopify:{},window.Shopify.customerPrivacy=window.Shopify.trackingConsent=Dn()}();
//# sourceMappingURL=consent-tracking-api.js.map
